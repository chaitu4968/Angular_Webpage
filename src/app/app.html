<!-- src/app/app.html -->
<div class="app-container">

  <!-- HERO -->
  <section class="hero">
    <div class="hero-inner">
      <div class="hero-text">
        <h1 class="hero-title">{{ title }}</h1>
        <p class="hero-subtitle">
          Search and download beautiful images in seconds.
        </p>

        <div class="hero-search">
          <app-search-bar (search)="onSearch($event)"></app-search-bar>
        </div>
      </div>
    </div>
  </section>

  <!-- MAIN CONTENT CARD -->
  <main class="content">

    <!-- Loading State -->
    @if (loading) {
      <div class="preloader-container">
        <div class="preloader">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <p>Loading images...</p>
      </div>
    }

    <!-- Error Message -->
    @if (error) {
      <p class="error-text">{{ error }}</p>
    }

    <!-- No Results -->
    @if (!loading && images.length === 0 && currentQuery && !error) {
      <p>No images found. Try a different keyword.</p>
    }

    <!-- Image Grid with POP-UP CARDS -->
    <div class="image-grid">
      @for (image of images; track image.id) {
        <div class="image-card" (click)="openImage(image)">
          <img
            [src]="image.urls.small"
            [alt]="image.alt_description || 'Unsplash Image'"
            loading="lazy"
            decoding="async"
          />
        </div>
      }
    </div>

    <!-- Load More Button AT BOTTOM ONLY -->
    @if (images.length > 0 && !loading) {
      <button
        type="button"
        class="load-more"
        (click)="loadMore()">
        Load More
      </button>
    }

    <!-- Image Popup / Modal -->
    @if (selectedImage) {
      <div class="modal-overlay" (click)="closeImage()">
        <div class="modal-content" (click)="$event.stopPropagation()">

          <button class="modal-close" type="button" (click)="closeImage()">Ã—</button>

          <img
            class="modal-image"
            [src]="selectedImage.urls.regular || selectedImage.urls.small"
            [alt]="selectedImage.alt_description || 'Image'"
          />

          <div class="modal-footer">
            <div class="modal-text">
              <div class="modal-title">
                {{ selectedImage.alt_description || 'Beautiful photo' }}
              </div>
              <div class="modal-author">
                Photo by {{ selectedImage.user?.name || 'Unknown' }} on Unsplash
              </div>
            </div>

            <div class="modal-actions">
              <a
                class="btn btn-secondary"
                [href]="selectedImage.links?.html"
                target="_blank"
                rel="noopener noreferrer"
              >
                View on Unsplash
              </a>
              <a
                class="btn btn-primary"
                [href]="selectedImage.links?.download || selectedImage.links?.download_location"
                target="_blank"
                rel="noopener noreferrer"
              >
                Download
              </a>
            </div>
          </div>

        </div>
      </div>
    }

  </main>
</div>
